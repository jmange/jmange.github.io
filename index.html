<!DOCTYPE HTML PUBLIC >
<html>
<head>
	<title>Science Olympiad - Learn Coding!  As a Ninja!</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
	<meta charset="utf-8">
	<script>
		var check_function=function() {return false;}; // global variable to hold function to check on running

function checkMatch() {
	return document.getElementById('output_body').innerHTML.replace('\n','<br>')==window.problems[problem_index].expected_output;
}

function checkGrid() { 
	for(var r=0; r<3; r++)
		for(var c=0; c<3; c++)
			if(document.getElementById('cell_'+r+'_'+c).style.backgroundColor!=document.getElementById('expectedcell_'+r+'_'+c).style.backgroundColor)
				return false;
	
	return true;
}
		var problem_index=-1;
		var outputMode='text';

		problems=[
			{
				instructions: 'Output the statement “Hello World” as shown in the example output.',
				expected_output: 'Hello World',
				output_mode: 'text',
				check_function: checkMatch,
				solution: 'console.log("Hello World");'
			},
			{
				instructions: 'Set a variable to the string “Hello World”; output that variable.',
				expected_output: 'Hello World',
				output_mode: 'text',
				check_function: checkMatch,
				solution: 'var message = "Hello World"; \nconsole.log(message);'
			},
			{
				instructions: 'Set a variable to false and then print out “True value” if it is true and “False value” if it is false.',
				expected_output: 'False Value',
				output_mode: 'text',
				check_function: checkMatch,
				solution: 'var truthValue = false;\n\nif(truthValue)\n	console.log("True value");\nelse\n	console.log("False Value");'
			},
			{
				instructions: 'Output the statement “Hello World” five times on separate lines as shown in the example output.',
				expected_output:'Hello World<br>Hello World<br>Hello World<br>Hello World<br>Hello World',
				output_mode: 'text',
				check_function: checkMatch,
				solution: 'for(var i = 0; i < 5; i++)\n	console.log("Hello World");'
			},
			{
				instructions: 'Output the statement “Hello World” five times on separate lines but add the number to the beginning of the output statement as shown in the example output.',
				expected_output:'1 Hello World<br>2 Hello World<br>3 Hello World<br>4 Hello World<br>5 Hello World',
				output_mode: 'text',
				check_function: checkMatch,
				solution: 'for(var i = 1; i < 6; i++)\n	console.log(i+" Hello World");'
			},
			{
				instructions: 'Output the statement “Hello World” five times on separate lines but on the third time change the output to “Goodbye World” as shown in the example output.',
				expected_output:'Hello World<br>Hello World<br>Goodbye World<br>Hello World<br>Hello World',
				output_mode: 'text',
				check_function: checkMatch,
				solution: 'for(var i = 0; i < 5; i++)\n if(i == 2)\n	console.log("Goodbye World");\n else\n	console.log("Hello World");'
			},
			{
				instructions: 'The function <span class="code">makeBoxBlue()</span> will change the color of the box. Using this information, change the box to the color blue.',
				expected_output: '<div class="box" id="expected_box" style="background-color: #007bff"></div>',
				output: '<div class="box" id="output_box"></div>',
				output_mode: 'box',
				check_function: function() {return document.getElementById('output_box').style.backgroundColor== document.getElementById('expected_box').style.backgroundColor},
				solution: 'makeBoxBlue();'
			},
			{
				instructions: 'The functions <span class="code">makeBoxBlue()</span>, <span class="code">makeBoxRed()</span>, <span class="code">makeBallBlue()</span>, and <span class="code">makeBallRed()</span> will change the colors of the box and ball. Using this information, change the box to the color red, and the ball to the color blue as shown in the example output.',
				expected_output: '<div class="box" id="expected_box" style="background-color: #007bff"></div><div class="circle" id="expected_circle" style="background-color:red"></div>',
				output: '<div class="box" id="output_box"></div><div class="circle" id="output_circle"></div>',
				output_mode: 'box and circle',
				check_function: function() {return (document.getElementById('output_box').style.backgroundColor==document.getElementById('expected_box').style.backgroundColor && document.getElementById('output_circle').style.backgroundColor==document.getElementById('expected_circle').style.backgroundColor);},
				solution: 'makeBoxBlue();\nmakeBallRed();'
			},
			{
				instructions: 'The function <span class="code">makeBlue(r,c)</span> will change the color of the box at the position with row r and column c. For example, <span class="code">makeBlue(0,0)</span> will change the top corner box because it is zero-based. Using this information, change the center box on the grid to the color blue as shown in the example output.',
				expected_output: '',
				output: '',
				output_mode: 'grid',
				solution: 'makeBlue(1,1);',
				check_function: checkGrid
			},
			{
				instructions: 'The function <span class="code">makeBlue(r,c)</span> will change the color of the box at the position with row r and column c. For example, <span class="code">makeBlue(0,0)</span> will change the top corner box because it is zero-based. Using this information, make all of the boxes on the diagonal blue (from top left to bottom right) as shown in the example output.',
				expected_output: '',
				output: '',
				output_mode: 'grid',
				solution: 'for(var i = 0; i < 3; i++)\n	makeBlue(i, i);',
				check_function: checkGrid
			}
		];

		problems[8].expected_output=makeBlankGrid(3, 'expected');
		problems[8].output=makeBlankGrid(3);
		problems[9].expected_output=makeBlankGrid(3, 'expected');
		problems[9].output=makeBlankGrid(3);

		// functions for the problems
		function makeBoxBlue(){
			document.getElementById('output_box').style.backgroundColor='#007bff';
		}

		function makeBoxRed(){
			document.getElementById('output_box').style.backgroundColor='red';
		}

		function makeBallBlue(){
			document.getElementById('output_circle').style.backgroundColor='#007bff';
		}

		function makeBallRed(){
			document.getElementById('output_circle').style.backgroundColor='red';
		}

		function makeBlankGrid(size, prefix='') {
            var grid='<table id="table_'+size+'" border=1>';
            for(var r=0; r<size; r++) {
                grid+="<tr>";
                for(var c=0; c<size; c++)
                    grid+='<td id="'+prefix+'cell_'+r+'_'+c+'">&nbsp;</td>';
                grid+="</tr>";
            }
            grid+="</table>";
            return grid;
        }

		function makeBlue(r,c,prefix=''){
			document.getElementById(prefix+'cell_'+r+'_'+c).style.backgroundColor='#007bff';
		}

		function isColor(r,c,color) {
			return document.getElementById('cell_'+r+'_'+c).style.backgroundColor==color;
		}

		function loadProblem(num) {
			if (num >= 0 && num < problems.length){
				editor.setValue("");
				problem=problems[num];
				problem_index=num;
				document.getElementById('instructions_body').innerHTML=problem.instructions;
				document.getElementById('expected_body').innerHTML=problem.expected_output;
				outputMode=problem.output_mode;
				document.getElementById('output_body').innerHTML='';
				if(problem.output)
					document.getElementById('output_body').innerHTML=problem.output;
				
				if(outputMode=='box' || outputMode=='box and circle')
					document.getElementById('output_box').style.backgroundColor='white';
				
				if(outputMode=='box and circle')
					document.getElementById('output_circle').style.backgroundColor='white';

				if(num==8)
					makeBlue(1,1,'expected');
				
				if(num==9)
					for(var i=0; i<3; i++)
						makeBlue(i,i,'expected');
				
				check_function=problem.check_function;
				document.getElementById('icon').src='images/disconnected.png';
				document.getElementById('output_body').style.backgroundColor='#fff';
				document.getElementById('expected_body').style.backgroundColor='#fff';

				if(outputMode!='text') {
					document.getElementById('output_body').style.textAlign='center';
					document.getElementById('output_body').style.justifyContent='center';
					document.getElementById('expected_body').style.textAlign='center';
				} else {
					document.getElementById('output_body').style.textAlign='left';
					document.getElementById('expected_body').style.textAlign='left';
				}


				run();
			}
		}

		function displaySolution(){
			editor.setValue("");
			var customPosition = {
				row: 0,
				column: 0
			}
			editor.session.insert(customPosition, problem.solution);
		}

	</script>
	<style type="text/css">
		table#table_3 td {
			width: 40px;
			height: 40px;
			background-color: white;
		}
	
		
		div.box {
			width: 150px;
			height: 150px;
			border: 2px solid black;
			background-color: white;
			position: absolute;
			margin: 0 auto;
		}

		div.circle {
			border-radius: 50%;
			width: 150px;
			height: 150px;
			border: 2px solid black;
			background-color: white;
			position: absolute;
		}

		span.code {
			font-family: monospace;
			background-color: #eee;
			padding: 2px;
		}

		body {
			font-family: Arial;
			font-size: 12pt;
			padding: 10px;
		}
		div {
			border: 0px solid black;
		}
		div.outer {
			border: 1px dotted gray;
			border-radius: 8px;
			position: relative;
		}
		div.title {
			padding: 5px;
			background-color: #004;
			color: white;
			font-weight: bold;
			font-size: 14pt;
			border-radius: 8px 8px 0 0;
		}
		div.body {
			padding: 5px;
			border-radius: 0 0 8px 8px;
		}
		
		div#instructions_outer {
			width: 1060px;
			margin-bottom: 10px;
		}
		div#code_outer {
			width: 500px;
			float: left;
		}
		div#output_outer {
			width: 243px;
			float: left;
			margin-left: 5px;
		}
		div#expected_outer {
			width: 243px;
			float: left;
			margin-left: 5px;
		}
		div#code_body, div#output_body, div#expected_body {
			height: 400px;
			font-family: monospace;
		}
		
		div#image_holder {
			float: left;
			padding: 200px 2px 0 5px;
		}
		
		button#solution{
			position: absolute; 
			bottom: 5px; 
			right: 100px;
			font-size: 14pt;
			font-weight: bold;
			padding: 3px 15px 3px 15px;
		}
		
		button#run {
			position: absolute; 
			bottom: 5px; 
			right: 5px;
			font-size: 14pt;
			font-weight: bold;
			padding: 3px 15px 3px 15px;
		}

		nav#prob_nav{
			float: left;
			padding: 10px 5px 0 5px;
		}

		nav#prob_nav_col{
			position: right;
		}
		
		span.error {
			color: red;
		}

	</style>
	<script src="ace/ace.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
	<div class="outer" style="float: left">
	<nav style="float: left; width: 150px" id="nav_list" class="nav nav-pills flex-column">
	</nav>
	</div>
	<script>
		// load all the navs
		for(var i=0; i<problems.length; i++) {
			var ul=document.getElementById('nav_list');
			
			var a=document.createElement('a');
			ul.appendChild(a);
			a.classList.add('nav-link');
			if(i==0) {
				a.classList.add('active');
				a.classList.add('show');
			}
			a.setAttribute('data-toggle', 'pill');
			a.setAttribute('aria-selected', 'false');
			a.setAttribute('onclick', 'javascript:loadProblem('+i+')')
			a.innerHTML='Problem '+(i+1);
			a.href='#';
		}
	</script>

	<div id="body_holder" style="float: left; padding-left: 10px">
		<div id="instructions_outer" class="outer">
			<div id="instructions_title" class="title">
				Instructions
			</div>	
			<div id="instructions_body" class="body">
				Here's how you do stuff!
			</div>		
		</div>
		
		<div id="code_outer" class="outer">
			<div id="code_title" class="title">
				Code
			</div>	
			<div id="code_body" class="body"></div>
			<button id="solution" onclick="displaySolution()">Solution</button>
			<button id="run" onclick="run()">Run!</button>
		</div>
		
		<div id="output_outer" class="outer">
			<div id="output_title" class="title">
				Output
			</div>	
			<div id="output_body" class="body">
				Output of your program
			</div>		
		</div>
		
		<div id="image_holder">
			<img id="icon" src="images/disconnected.png">
		</div>
		
		<div id="expected_outer" class="outer">
			<div id="expected_title" class="title">
				Expected Output
			</div>	
			<div id="expected_body" class="body">
				What you should see
			</div>		
		</div>
	</div>

		<div style="clear: both"></div>
		
		<nav id="prob_nav" aria-label="Problem_navigation">
			<ul class="pagination" id="nav_list">
			</ul>
		</nav>

	<script>	
		ace.config.set("basePath", "ace/");
		var editor = ace.edit("code_body");
		editor.session.setMode("ace/mode/javascript");
		editor.setOptions({fontSize: "12pt"});
		
		var former = console.log;
		console.log = function(msg){
			former(msg);  //maintains existing logging via the console.

			if(outputMode=='text') {
				if(document.getElementById('output_body').innerHTML=='')
					document.getElementById('output_body').innerHTML+=msg;
				else
					document.getElementById('output_body').innerHTML+='<br>'+msg;	
			}	
		}

		window.onerror = function(message) {
			console.log('<span class="error">Parsing error in code; please double-check your code and run again.</span>');
		}
		
		function run() {
			if(outputMode=='text')
				document.getElementById('output_body').innerHTML='';
			eval(editor.getValue());

			if(check_function()) {
				document.getElementById('icon').src='images/connected.png';
				document.getElementById('output_body').style.backgroundColor='#9f9';
				document.getElementById('expected_body').style.backgroundColor='#9f9';
			} else {
				document.getElementById('icon').src='images/disconnected.png';
				document.getElementById('output_body').style.backgroundColor='#fff';
				document.getElementById('expected_body').style.backgroundColor='#fff';
			}
		}

		window.addEventListener('keydown', function(event) { if(event.ctrlKey && event.keyCode==13) run(); });
		loadProblem(0);
	</script>
	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
</body>
</html>
